# BusinessAiAgent Bot

Документация по проекту BusinessAiAgent Bot — телеграм/чат-агент для бизнес-опросов и автоматизации диалогов.

## Описание

Проект реализует бота-агента для проведения опросов и взаимодействия с пользователями. В репозитории есть основной входной файл `app.py`, конфигурация в `config.py`, вспомогательные обработчики в папке `handlers/` и утилиты в `misc/`.

Ключевые возможности (из структуры проекта):
- Запуск бота из `app.py`.
- Обработчики опросов и старта в `handlers/start.py` и `handlers/survey.py`.
- Утилиты для взаимодействия с базой, клавиатурами и вспомогательными функциями в `misc/`.

## Быстрый старт

Ниже описаны шаги для локального запуска на Linux. Команды приведены с учётом того, что shell по умолчанию — fish.

### Установка (виртуальное окружение)

1. Создайте виртуальное окружение и активируйте его (fish):

```fish
python3 -m venv .venv
source .venv/bin/activate.fish
```

2. Установите зависимости:

```fish
pip install -r requirements.txt
```

### Запуск

Запустить приложение можно командой:

```fish
python app.py
```

Файл `config.py` содержит конфигурацию (токены, параметры БД и пр.). Перед запуском убедитесь, что необходимые переменные заданы в `config.py` или в окружении.

## Docker

В репозитории присутствуют `Dockerfile` и `docker-compose.yml` для контейнеризации.

Сборка образа и запуск (fish):

```fish
docker compose build
docker compose up -d
```

Если хотите запускать без `docker compose`, можно собрать и запустить образ вручную:

```fish
docker build -t businessai-bot .
docker run -d --name businessai-bot --env-file .env businessai-bot
```

## Структура проекта

Краткое описание файлов и папок:

- `app.py` — точка входа приложения.
- `config.py` — конфигурация (токены, параметры подключения к БД и пр.).
- `requirements.txt` — зависимости Python.
- `handlers/` — обработчики команд и логики бота:
  - `start.py` — обработчик команды /start и начальной логики.
  - `survey.py` — логика проведения опросов.
- `misc/` — утилиты и вспомогательные модули:
  - `functions.py` — вспомогательные функции.
  - `keyboards.py` — создание клавиатур и inline-кнопок.
  - `pgSQL.py` — работа с PostgreSQL (если используется).
- `README.md` — текущая документация.
- `TEST.py` — тестовый скрипт/заглушка.

## Конфигурация и переменные окружения

Если вы храните конфиденциальные данные (токены, пароли) в окружении, рекомендуется создать файл `.env` и загрузить значения в `config.py` (или использовать библиотеку `python-dotenv`). Пример переменных, которые могут понадобиться:

- TELEGRAM_TOKEN — токен бота
- DATABASE_URL или PGHOST/PGUSER/PGPASSWORD/PGDATABASE — параметры подключения к БД

Пример простого `.env`:

```
TELEGRAM_TOKEN=123456:ABC-DEF
DATABASE_URL=postgresql://user:pass@localhost:5432/dbname
```

## Запуск тестов / отладка

В репозитории есть `TEST.py` — используйте его для локальных быстрых проверок. Для более формализованных тестов можно добавить pytest и написать небольшие модульные тесты для функций из `misc/`.

## Отладка и troubleshooting

- Если бот не запускается — проверьте лог вывода `python app.py` или логи контейнера: `docker compose logs -f`.
- Ошибки импорта — убедитесь, что активировано виртуальное окружение и зависимости установлены.
- Проблемы с БД — проверьте доступность сервера и правильность строки подключения.

## Предложения по улучшению

Небольшие улучшения, которые можно добавить:
- Добавить unit-тесты (pytest) и CI (GitHub Actions).
- Добавить пример `.env.example` с описанием переменных.
- Расширить README примерами типичных сценариев использования и примерами API/сообщений бота.

## Лицензия

Добавьте файл `LICENSE` с выбранной лицензией проекта (например, MIT) или укажите лицензию в README.

## Контакты

Если нужно помочь с проектом — оставьте issue в репозитории или свяжитесь с автором (указан в метаданных репозитория).

---

README сгенерирован автоматически на основе структуры репозитория и доступных файлов.
Enviroment file structure

BOT_TOKEN=""

DSN="host=db user=postgres password= dbname=aibotdb port=5432 sslmode=disable"

POSTGRES_PASSWORD=""

ADMIN_IDS=""
